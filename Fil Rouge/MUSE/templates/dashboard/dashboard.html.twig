{% extends '@EasyAdmin/page/content.html.twig' %}

{% block title %}
	Dashboard
{% endblock %}
{% block main %}
	{# <div class="text-center mt-0">
		<img src='/img/Muse_rect_trans.png' style="width: 10rem; height:auto;">
	</div> #}

	<div class="row">

		{% include '/dashboard/bar_chart1.html.twig' %}
		<div class="row d-flex justify-content-center">
			<table class="columns">
				<tr>
					<td>
						<div id="piechart_div" style=""></div>
					</td>
					<td>
						<div id="barchart_div" style=""></div>
					</td>
				</tr>
			</table>
		</div>

		{# *** Charts.js *** #}

		{# <div class="col-12">
					{{ render_chart(chart) }}
				</div> #}


		<div class="col-md-3">
			<h3>Inscrits :
				{{ users|length }}
			</h3>
			<ul>{% set sumVal = 0 %}
				{% for cart in carts %}
					{% set sumVal = sumVal + cart.validated %}
				{% endfor %}
				<li>Nombre de paniers sans commande :
					<strong>{{ carts|length - sumVal }}</strong>
				</li>
				<li>Moyenne de commandes par utilisateur :
					<strong>{{ sumVal / users|length }}</strong>
				</li>
				<li>Moyenne des dépenses par utilisateur :
					{% set sum = 0 %}
					{% for cart in carts %}
						{% set sum = sum + cart.total %}
					{% endfor %}
					<strong>{{ sum / users|length }}</strong>
				</li>
			</ul>
		</div>

		<div class="col-md-3">
			<h3>Adresses :
				{{ addresses|length }}</h3>
			<ul>
				<li>
					Moyenne d'adresses par utilisateur:
					<strong>{{ addresses|length / users|length }}</strong>
				</li>
				{# {% for address in addresses|slice(0,3) %}
													<li>
														<a href="{{ path('app_address_show', {'id': address.id}) }}">{{ address.name }}</a>
														<br>- ({{ address.fullName }})
													</li>
												{% endfor %} #}
			</ul>
		</div>

		<div class="col-md-3">
			<h3>Fournisseurs :
				{{ suppliers|length }}
			</h3>
			<ul>
				<li>
					Moyenne de produits par fournisseur:
					<h5 class="text-primary">
						<strong>{{ products|length / suppliers|length }}</strong>
					</h5>
				</li>
			</ul>
		</div>

		<div class="col-md-3">
			<h3>Catégories :
				{{ categories|length }}
			</h3>
			<ul>
				<li>
					Moyenne de produits par catégorie:
					<h5 class="text-primary">
						<strong>{{ products|length / categories|length }}</strong>
					</h5>
				</li>
			</ul>
		</div>

		<div class="col-md-3">
			<h3>Produits :
				{{ products|length }}
			</h3>
			<ul>
				<li>Nombre d'adresses:
					{{ addresses|length  }}</li>
				<li>Nombre d'utilisateurs:
					{{ users|length }}</li>
				<li>
					Moyenne d'adresses par utilisateur:
					<h5 class="text-primary">
						<strong>{{ users|length / addresses|length }}</strong>
					</h5>
				</li>
			</ul>
		</div>

		<div class="col-md-3">
			<h3>Détails de commande :
				{{ orderDetails|length }}
			</h3>
			<ul>
				{% set sum = 0 %}
				{% for detail in orderDetails %}
					{% set sum = sum + detail.quantity %}
				{% endfor %}
				<li>
					Moyenne de produits par panier:
					<h5 class="text-primary">
						<strong>{{ sum / carts|length }}</strong>
					</h5>
				</li>
			</ul>
		</div>

		<div class="col-md-3">
			<h3>Paniers / commandes :
			</h3>
			<ul>
				{% set sum = 0 %}
				{% set sumVal = 0 %}
				{% for cart in carts %}
					{% set sum = sum + cart.total %}
					{% set sumVal = sumVal + cart.validated %}
				{% endfor %}
				<li>Nombre de paniers :
					<strong>{{ carts|length }}</strong>
				</li>
				<li>Nombre de commandes :
					<strong>{{ sumVal|length }}</strong>
				</li>
				<li>Moyenne des commandes par utilisateur :
					<strong>{{ sumVal / users|length }}</strong>
				</li>
				<li>Moyenne des dépenses par commande :
					<strong>{{ sum / sumVal }}</strong>
				</li>
			</ul>
		</div>

	</div>
	{% block javascripts %}
		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	{% endblock %}
{% endblock %}
